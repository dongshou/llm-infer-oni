2025-05-04 22:16:09.594 | INFO     | utils.logger:setup_logger:69 - 日志文件配置完成: logs/ai_controller_202505042216.log
2025-05-04 22:16:09.594 | INFO     | utils.logger:setup_logger:71 - 日志系统配置完成，级别: DEBUG
2025-05-04 22:16:09.594 | INFO     | __main__:main:200 - ==================================================
2025-05-04 22:16:09.594 | INFO     | __main__:main:201 - AI-UI-Controller 启动
2025-05-04 22:16:09.594 | INFO     | __main__:main:202 - 环境: dev
2025-05-04 22:16:09.594 | INFO     | __main__:main:203 - 任务: 建造一个制氧设备
2025-05-04 22:16:09.594 | INFO     | __main__:main:204 - 最大迭代次数: 20
2025-05-04 22:16:09.594 | INFO     | __main__:main:205 - 迭代延迟: 0.2秒
2025-05-04 22:16:09.594 | INFO     | __main__:main:206 - ==================================================
2025-05-04 22:16:09.594 | INFO     | base.agent:__init__:15 - Agent initialized with config
2025-05-04 22:16:09.594 | INFO     | core.ui_agent:__init__:27 - UI代理初始化完成，最大迭代次数=20，迭代延迟=0.2秒
2025-05-04 22:16:09.594 | INFO     | __main__:main:249 - 开始执行任务...
2025-05-04 22:16:09.594 | INFO     | core.ui_agent:setup:33 - 正在设置UI代理组件
2025-05-04 22:16:09.595 | DEBUG    | base.perception:__init__:14 - Perception module initialized
2025-05-04 22:16:09.595 | DEBUG    | core.screen_capture:__init__:26 - Screen capture initialized with min interval: 0.2s
2025-05-04 22:16:09.595 | DEBUG    | base.executor:__init__:14 - Executor module initialized
2025-05-04 22:16:09.595 | DEBUG    | core.input_controller:__init__:30 - Input controller initialized with move_duration=0.1, type_interval=0.1
2025-05-04 22:16:09.595 | DEBUG    | base.brain:__init__:14 - Brain module initialized
2025-05-04 22:16:09.595 | INFO     | core.llm_decision:__init__:41 - 使用自定义API端点: https://yunwu.ai/v1
2025-05-04 22:16:09.639 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: default
2025-05-04 22:16:09.640 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: browser
2025-05-04 22:16:09.641 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: text_input
2025-05-04 22:16:09.641 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: office
2025-05-04 22:16:09.642 | DEBUG    | utils.prompt_manager:load_prompts:210 - 从文件加载提示词: oxygen_not_included
2025-05-04 22:16:09.642 | INFO     | utils.prompt_manager:load_prompts:237 - 已加载5个提示词
2025-05-04 22:16:09.642 | INFO     | utils.prompt_manager:__init__:44 - 提示词管理器初始化完成，加载了5个提示词
2025-05-04 22:16:09.642 | INFO     | core.llm_decision:__init__:51 - 大模型决策模块初始化完成，使用模型: o4-mini
2025-05-04 22:16:09.642 | INFO     | core.llm_decision:__init__:52 - 已加载5个提示词
2025-05-04 22:16:09.642 | INFO     | core.ui_agent:setup:47 - UI代理组件初始化完成
2025-05-04 22:16:09.642 | INFO     | core.ui_agent:setup_middlewares:51 - 正在设置UI代理中间件
2025-05-04 22:16:09.642 | DEBUG    | base.middleware:__init__:96 - Middleware manager initialized
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:__init__:14 - LoggingMiddleware middleware initialized
2025-05-04 22:16:09.644 | INFO     | middlewares.logging_mw:__init__:26 - 日志中间件初始化完成，日志级别: DEBUG
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:add:111 - Added middleware: LoggingMiddleware
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:__init__:14 - ThrottlingMiddleware middleware initialized
2025-05-04 22:16:09.644 | INFO     | middlewares.throttling:__init__:35 - 限流中间件初始化完成，默认延迟: 1.0秒
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:add:111 - Added middleware: ThrottlingMiddleware
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:__init__:14 - StateTrackingMiddleware middleware initialized
2025-05-04 22:16:09.644 | INFO     | middlewares.state_tracking:__init__:35 - 状态追踪中间件初始化完成，最大历史记录数: 10
2025-05-04 22:16:09.644 | DEBUG    | base.middleware:add:111 - Added middleware: StateTrackingMiddleware
2025-05-04 22:16:09.645 | DEBUG    | base.middleware:__init__:14 - ScreenshotLoggerMiddleware middleware initialized
2025-05-04 22:16:09.645 | DEBUG    | middlewares.screenshot_logger:_ensure_dirs:65 - 创建截图记录目录: logs/screenshots/20250504_221609
2025-05-04 22:16:09.645 | INFO     | middlewares.screenshot_logger:__init__:60 - 截图记录中间件初始化完成，记录目录: logs/screenshots/20250504_221609
2025-05-04 22:16:09.645 | DEBUG    | base.middleware:add:111 - Added middleware: ScreenshotLoggerMiddleware
2025-05-04 22:16:09.645 | INFO     | core.ui_agent:setup_middlewares:66 - UI代理中间件初始化完成
2025-05-04 22:16:09.645 | INFO     | core.ui_agent:run:87 - 开始执行UI代理任务: '建造一个制氧设备'
2025-05-04 22:16:09.645 | INFO     | core.ui_agent:run:88 - 使用提示词: oxygen_not_included
2025-05-04 22:16:09.645 | INFO     | core.ui_agent:run:104 - 迭代 1/20
2025-05-04 22:16:09.645 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-04 22:16:09.645 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #1 (迭代 1) 开始 =====
2025-05-04 22:16:09.645 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-04 22:16:10.025 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-04 22:16:10.468 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1544, y=602)
2025-05-04 22:16:10.468 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1544, y=602)
2025-05-04 22:16:10.511 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250504_221609/step_0001_1746368170_before.png
2025-05-04 22:16:10.511 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-04 22:16:10.512 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-04 22:16:10.513 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-04 22:16:59.642 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时49.13秒
2025-05-04 22:16:59.647 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 80, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 120, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 760, 'y': 380}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 140, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 180, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 700, 'y': 360}, {'type': 'move', 'x': 740, 'y': 380, 'duration': 0.4}, {'type': 'click', 'button': 'left', 'is_drag': True}, {'type': 'move', 'x': 760, 'y': 380}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['p']}, {'type': 'move', 'x': 758, 'y': 375}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['p']}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:16:59.647 | INFO     | core.ui_agent:step:195 - 决策结果: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 80, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 120, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 760, 'y': 380}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 140, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 180, 'y': 650}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 700, 'y': 360}, {'type': 'move', 'x': 740, 'y': 380, 'duration': 0.4}, {'type': 'click', 'button': 'left', 'is_drag': True}, {'type': 'move', 'x': 760, 'y': 380}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['p']}, {'type': 'move', 'x': 758, 'y': 375}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['p']}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:16:59.648 | INFO     | middlewares.logging_mw:process_after_decision:99 - 决策: 批量动作 (共 21 个)
2025-05-04 22:16:59.652 | INFO     | middlewares.logging_mw:process_after_decision:101 -   1. 按键 space
2025-05-04 22:16:59.652 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:16:59.653 | INFO     | middlewares.logging_mw:process_after_decision:101 -   2. 移动鼠标到 (80, 650)
2025-05-04 22:16:59.653 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 80, "y": 650}
2025-05-04 22:16:59.653 | INFO     | middlewares.logging_mw:process_after_decision:101 -   3. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.653 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.653 | INFO     | middlewares.logging_mw:process_after_decision:101 -   4. 移动鼠标到 (120, 650)
2025-05-04 22:16:59.653 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 120, "y": 650}
2025-05-04 22:16:59.653 | INFO     | middlewares.logging_mw:process_after_decision:101 -   5. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.654 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.654 | INFO     | middlewares.logging_mw:process_after_decision:101 -   6. 移动鼠标到 (760, 380)
2025-05-04 22:16:59.654 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 760, "y": 380}
2025-05-04 22:16:59.654 | INFO     | middlewares.logging_mw:process_after_decision:101 -   7. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.654 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.654 | INFO     | middlewares.logging_mw:process_after_decision:101 -   8. 移动鼠标到 (140, 650)
2025-05-04 22:16:59.654 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 140, "y": 650}
2025-05-04 22:16:59.654 | INFO     | middlewares.logging_mw:process_after_decision:101 -   9. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.654 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   10. 移动鼠标到 (180, 650)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 180, "y": 650}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   11. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   12. 移动鼠标到 (700, 360)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 700, "y": 360}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   13. 移动鼠标到 (740, 380)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 740, "y": 380, "duration": 0.4}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   14. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left", "is_drag": true}
2025-05-04 22:16:59.655 | INFO     | middlewares.logging_mw:process_after_decision:101 -   15. 移动鼠标到 (760, 380)
2025-05-04 22:16:59.655 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 760, "y": 380}
2025-05-04 22:16:59.656 | INFO     | middlewares.logging_mw:process_after_decision:101 -   16. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.656 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.656 | INFO     | middlewares.logging_mw:process_after_decision:101 -   17. 按键 p
2025-05-04 22:16:59.657 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["p"]}
2025-05-04 22:16:59.657 | INFO     | middlewares.logging_mw:process_after_decision:101 -   18. 移动鼠标到 (758, 375)
2025-05-04 22:16:59.657 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 758, "y": 375}
2025-05-04 22:16:59.657 | INFO     | middlewares.logging_mw:process_after_decision:101 -   19. 点击鼠标 left 在 (0, 0)
2025-05-04 22:16:59.657 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:16:59.657 | INFO     | middlewares.logging_mw:process_after_decision:101 -   20. 按键 p
2025-05-04 22:16:59.657 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["p"]}
2025-05-04 22:16:59.657 | INFO     | middlewares.logging_mw:process_after_decision:101 -   21. 按键 space
2025-05-04 22:16:59.657 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:16:59.660 | DEBUG    | middlewares.screenshot_logger:_log_single_action:94 - 模型分析已保存: logs/screenshots/20250504_221609/step_0001_1746368170_analysis.txt
2025-05-04 22:16:59.662 | DEBUG    | middlewares.screenshot_logger:_log_single_action:129 - 动作已记录到日志: key
2025-05-04 22:16:59.663 | INFO     | middlewares.screenshot_logger:_log_single_action:136 - 模型分析: 第一步，屏幕状态观察与分析
2025-05-04 22:16:59.666 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          1. 当前屏幕中央为打印舱与 3 名复制人（复制人生命值均正常，压力 5%），周围一片空旷岩层，左侧有一池液体（水或液态氧），右侧有少量可开采植物。
2025-05-04 22:16:59.675 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          2. 顶部 UI 显示：周期 1、12 小时进度、3 名复制人、压力 5%、储备卡路里 16,000 kcal；左侧为基础建造分类按钮，右侧暂无工具面板打开，底部显示建造快捷栏（基地、氧气、电力、水管...
2025-05-04 22:16:59.675 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          3. 当前未建造任何制氧设备，空气中暂时依赖启动时自带缓冲，需尽快搭建一个“藻类脱氧器（Algae Deoxidizer）”并接入电网。
2025-05-04 22:16:59.675 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          第二步，达成“建造藻类脱氧器”目标的行动规划
2025-05-04 22:16:59.676 | INFO     | middlewares.screenshot_logger:_log_single_action:138 -          ... (更多分析内容已保存到文件)
2025-05-04 22:16:59.676 | DEBUG    | middlewares.logging_mw:process_before_execution:119 - 准备执行动作: key
2025-05-04 22:16:59.687 | DEBUG    | core.ui_agent:step:232 - 正在执行动作
2025-05-04 22:17:00.234 | DEBUG    | core.input_controller:_press_key:235 - Key pressed: space
2025-05-04 22:17:00.235 | INFO     | middlewares.logging_mw:_log_single_result:139 - 执行成功: key 动作
2025-05-04 22:17:00.235 | DEBUG    | middlewares.logging_mw:process_after_execution:155 - ===== 操作 #1 完成，总耗时: 50.59秒 =====
2025-05-04 22:17:00.236 | DEBUG    | middlewares.throttling:process_after_execution:116 - 动作执行耗时: 50.59秒
2025-05-04 22:17:00.238 | DEBUG    | middlewares.screenshot_logger:process_after_execution:224 - 执行结果已记录: logs/screenshots/20250504_221609/step_0001_1746368170_before_result.json
2025-05-04 22:17:00.238 | DEBUG    | core.ui_agent:step:256 - 步骤执行完成，耗时: 50.59秒
2025-05-04 22:17:00.536 | INFO     | core.ui_agent:run:104 - 迭代 2/20
2025-05-04 22:17:00.537 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-04 22:17:00.537 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #2 (迭代 2) 开始 =====
2025-05-04 22:17:00.538 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-04 22:17:01.036 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-04 22:17:02.841 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1544, y=602)
2025-05-04 22:17:02.842 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1544, y=602)
2025-05-04 22:17:02.886 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250504_221609/step_0002_1746368222_before.png
2025-05-04 22:17:02.886 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-04 22:17:02.887 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-04 22:17:02.890 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-04 22:17:22.980 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时20.09秒
2025-05-04 22:17:22.982 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 120, 'y': 820}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 200, 'y': 860}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 700, 'y': 450}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:17:22.988 | INFO     | core.ui_agent:step:195 - 决策结果: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 120, 'y': 820}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 200, 'y': 860}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 700, 'y': 450}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:17:22.990 | INFO     | middlewares.logging_mw:process_after_decision:99 - 决策: 批量动作 (共 8 个)
2025-05-04 22:17:22.990 | INFO     | middlewares.logging_mw:process_after_decision:101 -   1. 按键 space
2025-05-04 22:17:22.990 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:17:22.990 | INFO     | middlewares.logging_mw:process_after_decision:101 -   2. 移动鼠标到 (120, 820)
2025-05-04 22:17:22.990 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 120, "y": 820}
2025-05-04 22:17:22.991 | INFO     | middlewares.logging_mw:process_after_decision:101 -   3. 点击鼠标 left 在 (0, 0)
2025-05-04 22:17:22.991 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:17:22.992 | INFO     | middlewares.logging_mw:process_after_decision:101 -   4. 移动鼠标到 (200, 860)
2025-05-04 22:17:22.992 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 200, "y": 860}
2025-05-04 22:17:22.992 | INFO     | middlewares.logging_mw:process_after_decision:101 -   5. 点击鼠标 left 在 (0, 0)
2025-05-04 22:17:22.992 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:17:22.992 | INFO     | middlewares.logging_mw:process_after_decision:101 -   6. 移动鼠标到 (700, 450)
2025-05-04 22:17:22.992 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 700, "y": 450}
2025-05-04 22:17:22.992 | INFO     | middlewares.logging_mw:process_after_decision:101 -   7. 点击鼠标 left 在 (0, 0)
2025-05-04 22:17:22.992 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:17:22.993 | INFO     | middlewares.logging_mw:process_after_decision:101 -   8. 按键 space
2025-05-04 22:17:22.993 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:17:22.993 | DEBUG    | middlewares.screenshot_logger:_log_single_action:94 - 模型分析已保存: logs/screenshots/20250504_221609/step_0002_1746368222_analysis.txt
2025-05-04 22:17:22.995 | DEBUG    | middlewares.screenshot_logger:_log_single_action:129 - 动作已记录到日志: key
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:136 - 模型分析: 1. 当前屏幕状态分析
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 基地布局：
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 中央平台上有一个手动发电机和一个研究站，三名复制人正聚集在平台上。
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 平台下方是未被完全开采的矿区和大量液体（水或其他液体）。
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 右侧有一小块植物区和一些空洞。
2025-05-04 22:17:22.995 | INFO     | middlewares.screenshot_logger:_log_single_action:138 -          ... (更多分析内容已保存到文件)
2025-05-04 22:17:22.996 | DEBUG    | middlewares.logging_mw:process_before_execution:119 - 准备执行动作: key
2025-05-04 22:17:22.996 | DEBUG    | core.ui_agent:step:232 - 正在执行动作
2025-05-04 22:17:23.411 | DEBUG    | core.input_controller:_press_key:235 - Key pressed: space
2025-05-04 22:17:23.412 | INFO     | middlewares.logging_mw:_log_single_result:139 - 执行成功: key 动作
2025-05-04 22:17:23.412 | DEBUG    | middlewares.logging_mw:process_after_execution:155 - ===== 操作 #2 完成，总耗时: 22.87秒 =====
2025-05-04 22:17:23.412 | DEBUG    | middlewares.throttling:process_after_execution:116 - 动作执行耗时: 22.87秒
2025-05-04 22:17:23.413 | DEBUG    | middlewares.screenshot_logger:process_after_execution:224 - 执行结果已记录: logs/screenshots/20250504_221609/step_0002_1746368222_before_result.json
2025-05-04 22:17:23.413 | DEBUG    | core.ui_agent:step:256 - 步骤执行完成，耗时: 22.88秒
2025-05-04 22:17:23.710 | INFO     | core.ui_agent:run:104 - 迭代 3/20
2025-05-04 22:17:23.711 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-04 22:17:23.713 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #3 (迭代 3) 开始 =====
2025-05-04 22:17:23.713 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-04 22:17:24.191 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-04 22:17:25.974 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1544, y=602)
2025-05-04 22:17:25.975 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1544, y=602)
2025-05-04 22:17:26.019 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250504_221609/step_0003_1746368245_before.png
2025-05-04 22:17:26.020 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-04 22:17:26.020 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-04 22:17:26.022 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-04 22:18:08.447 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时42.42秒
2025-05-04 22:18:08.449 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 150, 'y': 950}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 200, 'y': 950}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 800, 'y': 600}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:18:08.450 | INFO     | core.ui_agent:step:195 - 决策结果: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 150, 'y': 950}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 200, 'y': 950}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 800, 'y': 600}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:18:08.450 | INFO     | middlewares.logging_mw:process_after_decision:99 - 决策: 批量动作 (共 8 个)
2025-05-04 22:18:08.450 | INFO     | middlewares.logging_mw:process_after_decision:101 -   1. 按键 space
2025-05-04 22:18:08.451 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:18:08.451 | INFO     | middlewares.logging_mw:process_after_decision:101 -   2. 移动鼠标到 (150, 950)
2025-05-04 22:18:08.451 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 150, "y": 950}
2025-05-04 22:18:08.451 | INFO     | middlewares.logging_mw:process_after_decision:101 -   3. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:08.451 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:08.453 | INFO     | middlewares.logging_mw:process_after_decision:101 -   4. 移动鼠标到 (200, 950)
2025-05-04 22:18:08.455 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 200, "y": 950}
2025-05-04 22:18:08.455 | INFO     | middlewares.logging_mw:process_after_decision:101 -   5. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:08.455 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:08.455 | INFO     | middlewares.logging_mw:process_after_decision:101 -   6. 移动鼠标到 (800, 600)
2025-05-04 22:18:08.455 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 800, "y": 600}
2025-05-04 22:18:08.455 | INFO     | middlewares.logging_mw:process_after_decision:101 -   7. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:08.455 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:08.455 | INFO     | middlewares.logging_mw:process_after_decision:101 -   8. 按键 space
2025-05-04 22:18:08.457 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:18:08.460 | DEBUG    | middlewares.screenshot_logger:_log_single_action:94 - 模型分析已保存: logs/screenshots/20250504_221609/step_0003_1746368245_analysis.txt
2025-05-04 22:18:08.463 | DEBUG    | middlewares.screenshot_logger:_log_single_action:129 - 动作已记录到日志: key
2025-05-04 22:18:08.463 | INFO     | middlewares.screenshot_logger:_log_single_action:136 - 模型分析: 以下是当前屏幕的观察与分析，以及为“建造一个制氧设备”所制定的具体操作步骤。
2025-05-04 22:18:08.463 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          1. 当前屏幕状态分析
2025-05-04 22:18:08.464 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 进入周期1，氧气仅有约2%，基地几乎无可呼吸氧气，复制人快要窒息。
2025-05-04 22:18:08.466 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 中央有已打印的孵化舱、打印舱和复制人；地面已铺平，可直接放置建筑。
2025-05-04 22:18:08.467 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 屏幕下方资源显示：16,000千卡食物充足，但无任何金属或其他建筑材料；也未采集到藻类（Algae）资源。
2025-05-04 22:18:08.472 | INFO     | middlewares.screenshot_logger:_log_single_action:138 -          ... (更多分析内容已保存到文件)
2025-05-04 22:18:08.473 | DEBUG    | middlewares.logging_mw:process_before_execution:119 - 准备执行动作: key
2025-05-04 22:18:08.473 | DEBUG    | core.ui_agent:step:232 - 正在执行动作
2025-05-04 22:18:08.897 | DEBUG    | core.input_controller:_press_key:235 - Key pressed: space
2025-05-04 22:18:08.897 | INFO     | middlewares.logging_mw:_log_single_result:139 - 执行成功: key 动作
2025-05-04 22:18:08.898 | DEBUG    | middlewares.logging_mw:process_after_execution:155 - ===== 操作 #3 完成，总耗时: 45.18秒 =====
2025-05-04 22:18:08.898 | DEBUG    | middlewares.throttling:process_after_execution:116 - 动作执行耗时: 45.18秒
2025-05-04 22:18:08.899 | DEBUG    | middlewares.screenshot_logger:process_after_execution:224 - 执行结果已记录: logs/screenshots/20250504_221609/step_0003_1746368245_before_result.json
2025-05-04 22:18:08.899 | DEBUG    | core.ui_agent:step:256 - 步骤执行完成，耗时: 45.19秒
2025-05-04 22:18:09.195 | INFO     | core.ui_agent:run:104 - 迭代 4/20
2025-05-04 22:18:09.195 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-04 22:18:09.195 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #4 (迭代 4) 开始 =====
2025-05-04 22:18:09.195 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-04 22:18:10.094 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-04 22:18:12.537 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1544, y=602)
2025-05-04 22:18:12.538 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1544, y=602)
2025-05-04 22:18:12.652 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250504_221609/step_0004_1746368292_before.png
2025-05-04 22:18:12.652 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-04 22:18:12.653 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-04 22:18:12.655 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-04 22:18:42.692 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时30.04秒
2025-05-04 22:18:42.693 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 1700, 'y': 60}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1450, 'y': 300}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1500, 'y': 750}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:18:42.694 | INFO     | core.ui_agent:step:195 - 决策结果: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 1700, 'y': 60}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1450, 'y': 300}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1500, 'y': 750}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-04 22:18:42.694 | INFO     | middlewares.logging_mw:process_after_decision:99 - 决策: 批量动作 (共 8 个)
2025-05-04 22:18:42.694 | INFO     | middlewares.logging_mw:process_after_decision:101 -   1. 按键 space
2025-05-04 22:18:42.695 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:18:42.695 | INFO     | middlewares.logging_mw:process_after_decision:101 -   2. 移动鼠标到 (1700, 60)
2025-05-04 22:18:42.696 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 1700, "y": 60}
2025-05-04 22:18:42.696 | INFO     | middlewares.logging_mw:process_after_decision:101 -   3. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:42.696 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:42.702 | INFO     | middlewares.logging_mw:process_after_decision:101 -   4. 移动鼠标到 (1450, 300)
2025-05-04 22:18:42.702 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 1450, "y": 300}
2025-05-04 22:18:42.702 | INFO     | middlewares.logging_mw:process_after_decision:101 -   5. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:42.702 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:42.702 | INFO     | middlewares.logging_mw:process_after_decision:101 -   6. 移动鼠标到 (1500, 750)
2025-05-04 22:18:42.702 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 1500, "y": 750}
2025-05-04 22:18:42.703 | INFO     | middlewares.logging_mw:process_after_decision:101 -   7. 点击鼠标 left 在 (0, 0)
2025-05-04 22:18:42.703 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-04 22:18:42.703 | INFO     | middlewares.logging_mw:process_after_decision:101 -   8. 按键 space
2025-05-04 22:18:42.703 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-04 22:18:42.704 | DEBUG    | middlewares.screenshot_logger:_log_single_action:94 - 模型分析已保存: logs/screenshots/20250504_221609/step_0004_1746368292_analysis.txt
2025-05-04 22:18:42.705 | DEBUG    | middlewares.screenshot_logger:_log_single_action:129 - 动作已记录到日志: key
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:136 - 模型分析: 1. 当前屏幕和状态分析
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 中央视图可以看到打印舱、研究站和两个复制人，底层有一口水池。
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 气体层显示周围已有约1500 g 的氧气温度21 ℃，但目前没有主动制氧装置，氧气量随呼吸会迅速下降。
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 左上角提示“未建造制氧生产设备”和“未建造厕所”，复制人正处于缺氧风险中。
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 顶部工具栏可见“状态、饮食、优先级、日程、技能、研究、星图”等按钮，当前“研究”尚未打开。
2025-05-04 22:18:42.705 | INFO     | middlewares.screenshot_logger:_log_single_action:138 -          ... (更多分析内容已保存到文件)
2025-05-04 22:18:42.706 | DEBUG    | middlewares.logging_mw:process_before_execution:119 - 准备执行动作: key
2025-05-04 22:18:42.706 | DEBUG    | core.ui_agent:step:232 - 正在执行动作
2025-05-04 22:18:43.116 | DEBUG    | core.input_controller:_press_key:235 - Key pressed: space
2025-05-04 22:18:43.117 | INFO     | middlewares.logging_mw:_log_single_result:139 - 执行成功: key 动作
2025-05-04 22:18:43.117 | DEBUG    | middlewares.logging_mw:process_after_execution:155 - ===== 操作 #4 完成，总耗时: 33.92秒 =====
2025-05-04 22:18:43.117 | DEBUG    | middlewares.throttling:process_after_execution:116 - 动作执行耗时: 33.92秒
2025-05-04 22:18:43.119 | DEBUG    | middlewares.screenshot_logger:process_after_execution:224 - 执行结果已记录: logs/screenshots/20250504_221609/step_0004_1746368292_before_result.json
2025-05-04 22:18:43.119 | DEBUG    | core.ui_agent:step:256 - 步骤执行完成，耗时: 33.92秒
2025-05-04 22:18:43.419 | INFO     | core.ui_agent:run:104 - 迭代 5/20
2025-05-04 22:18:43.419 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-04 22:18:43.420 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #5 (迭代 5) 开始 =====
2025-05-04 22:18:43.420 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-04 22:18:43.917 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-04 22:18:45.897 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1544, y=602)
2025-05-04 22:18:45.898 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1544, y=602)
2025-05-04 22:18:45.955 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250504_221609/step_0005_1746368325_before.png
2025-05-04 22:18:45.956 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-04 22:18:45.956 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-04 22:18:45.958 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-04 22:18:57.317 | INFO     | core.ui_agent:run:124 - UI代理被用户中断
2025-05-04 22:18:57.318 | INFO     | core.ui_agent:stop:268 - UI代理已停止
2025-05-04 22:18:57.319 | INFO     | core.ui_agent:run:132 - UI代理在5次迭代后完成，用时167.67秒
2025-05-04 22:18:57.319 | INFO     | __main__:main:255 - ==================================================
2025-05-04 22:18:57.319 | INFO     | __main__:main:256 - 任务执行完成，总用时: 167.72秒
2025-05-04 22:18:57.319 | INFO     | __main__:main:257 - 总迭代次数: 5
2025-05-04 22:18:57.319 | INFO     | __main__:main:264 - 操作总数: 8, 成功: 8, 失败: 0
2025-05-04 22:18:57.319 | INFO     | __main__:main:266 - ==================================================
