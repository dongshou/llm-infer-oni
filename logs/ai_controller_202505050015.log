2025-05-05 00:15:07.463 | INFO     | utils.logger:setup_logger:69 - 日志文件配置完成: logs/ai_controller_202505050015.log
2025-05-05 00:15:07.464 | INFO     | utils.logger:setup_logger:71 - 日志系统配置完成，级别: DEBUG
2025-05-05 00:15:07.464 | INFO     | __main__:main:200 - ==================================================
2025-05-05 00:15:07.464 | INFO     | __main__:main:201 - AI-UI-Controller 启动
2025-05-05 00:15:07.464 | INFO     | __main__:main:202 - 环境: dev
2025-05-05 00:15:07.464 | INFO     | __main__:main:203 - 任务: 建造一个制氧设备
2025-05-05 00:15:07.464 | INFO     | __main__:main:204 - 最大迭代次数: 20
2025-05-05 00:15:07.464 | INFO     | __main__:main:205 - 迭代延迟: 0.2秒
2025-05-05 00:15:07.464 | INFO     | __main__:main:206 - ==================================================
2025-05-05 00:15:07.464 | INFO     | base.agent:__init__:15 - Agent initialized with config
2025-05-05 00:15:07.464 | INFO     | core.ui_agent:__init__:27 - UI代理初始化完成，最大迭代次数=20，迭代延迟=0.2秒
2025-05-05 00:15:07.464 | INFO     | __main__:main:249 - 开始执行任务...
2025-05-05 00:15:07.464 | INFO     | core.ui_agent:setup:33 - 正在设置UI代理组件
2025-05-05 00:15:07.464 | DEBUG    | base.perception:__init__:14 - Perception module initialized
2025-05-05 00:15:07.464 | DEBUG    | core.screen_capture:__init__:26 - Screen capture initialized with min interval: 0.2s
2025-05-05 00:15:07.465 | DEBUG    | base.executor:__init__:14 - Executor module initialized
2025-05-05 00:15:07.465 | DEBUG    | core.input_controller:__init__:31 - Input controller initialized, move_duration=0.1, type_interval=0.1
2025-05-05 00:15:07.465 | DEBUG    | base.brain:__init__:14 - Brain module initialized
2025-05-05 00:15:07.465 | INFO     | core.llm_decision:__init__:41 - 使用自定义API端点: https://yunwu.ai/v1
2025-05-05 00:15:07.533 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: default
2025-05-05 00:15:07.533 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: browser
2025-05-05 00:15:07.534 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: text_input
2025-05-05 00:15:07.534 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: office
2025-05-05 00:15:07.535 | DEBUG    | utils.prompt_manager:load_prompts:210 - 从文件加载提示词: oxygen_not_included
2025-05-05 00:15:07.535 | INFO     | utils.prompt_manager:load_prompts:237 - 已加载5个提示词
2025-05-05 00:15:07.535 | INFO     | utils.prompt_manager:__init__:44 - 提示词管理器初始化完成，加载了5个提示词
2025-05-05 00:15:07.535 | INFO     | core.llm_decision:__init__:51 - 大模型决策模块初始化完成，使用模型: o4-mini
2025-05-05 00:15:07.535 | INFO     | core.llm_decision:__init__:52 - 已加载5个提示词
2025-05-05 00:15:07.535 | INFO     | core.ui_agent:setup:47 - UI代理组件初始化完成
2025-05-05 00:15:07.535 | INFO     | core.ui_agent:setup_middlewares:51 - 正在设置UI代理中间件
2025-05-05 00:15:07.535 | DEBUG    | base.middleware:__init__:96 - Middleware manager initialized
2025-05-05 00:15:07.538 | DEBUG    | base.middleware:__init__:14 - LoggingMiddleware middleware initialized
2025-05-05 00:15:07.538 | INFO     | middlewares.logging_mw:__init__:26 - 日志中间件初始化完成，日志级别: DEBUG
2025-05-05 00:15:07.538 | DEBUG    | base.middleware:add:111 - Added middleware: LoggingMiddleware
2025-05-05 00:15:07.538 | DEBUG    | base.middleware:__init__:14 - ThrottlingMiddleware middleware initialized
2025-05-05 00:15:07.538 | INFO     | middlewares.throttling:__init__:35 - 限流中间件初始化完成，默认延迟: 1.0秒
2025-05-05 00:15:07.538 | DEBUG    | base.middleware:add:111 - Added middleware: ThrottlingMiddleware
2025-05-05 00:15:07.539 | DEBUG    | base.middleware:__init__:14 - StateTrackingMiddleware middleware initialized
2025-05-05 00:15:07.539 | INFO     | middlewares.state_tracking:__init__:35 - 状态追踪中间件初始化完成，最大历史记录数: 10
2025-05-05 00:15:07.539 | DEBUG    | base.middleware:add:111 - Added middleware: StateTrackingMiddleware
2025-05-05 00:15:07.540 | DEBUG    | base.middleware:__init__:14 - ScreenshotLoggerMiddleware middleware initialized
2025-05-05 00:15:07.540 | DEBUG    | middlewares.screenshot_logger:_ensure_dirs:65 - 创建截图记录目录: logs/screenshots/20250505_001507
2025-05-05 00:15:07.540 | INFO     | middlewares.screenshot_logger:__init__:60 - 截图记录中间件初始化完成，记录目录: logs/screenshots/20250505_001507
2025-05-05 00:15:07.540 | DEBUG    | base.middleware:add:111 - Added middleware: ScreenshotLoggerMiddleware
2025-05-05 00:15:07.540 | INFO     | core.ui_agent:setup_middlewares:66 - UI代理中间件初始化完成
2025-05-05 00:15:07.540 | INFO     | core.ui_agent:run:87 - 开始执行UI代理任务: '建造一个制氧设备'
2025-05-05 00:15:07.540 | INFO     | core.ui_agent:run:88 - 使用提示词: oxygen_not_included
2025-05-05 00:15:07.540 | INFO     | core.ui_agent:run:104 - 迭代 1/20
2025-05-05 00:15:07.541 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-05 00:15:07.541 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #1 (迭代 1) 开始 =====
2025-05-05 00:15:07.541 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-05 00:15:07.904 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-05 00:15:08.335 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=1761, y=947)
2025-05-05 00:15:08.335 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=1761, y=947)
2025-05-05 00:15:08.410 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250505_001507/step_0001_1746375308_before.png
2025-05-05 00:15:08.410 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-05 00:15:08.410 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-05 00:15:49.226 | INFO     | utils.logger:setup_logger:69 - 日志文件配置完成: logs/ai_controller_202505050015.log
2025-05-05 00:15:49.227 | INFO     | utils.logger:setup_logger:71 - 日志系统配置完成，级别: DEBUG
2025-05-05 00:15:49.227 | INFO     | __main__:main:200 - ==================================================
2025-05-05 00:15:49.227 | INFO     | __main__:main:201 - AI-UI-Controller 启动
2025-05-05 00:15:49.227 | INFO     | __main__:main:202 - 环境: dev
2025-05-05 00:15:49.227 | INFO     | __main__:main:203 - 任务: 建造一个制氧设备
2025-05-05 00:15:49.227 | INFO     | __main__:main:204 - 最大迭代次数: 20
2025-05-05 00:15:49.227 | INFO     | __main__:main:205 - 迭代延迟: 0.2秒
2025-05-05 00:15:49.227 | INFO     | __main__:main:206 - ==================================================
2025-05-05 00:15:49.227 | INFO     | base.agent:__init__:15 - Agent initialized with config
2025-05-05 00:15:49.227 | INFO     | core.ui_agent:__init__:27 - UI代理初始化完成，最大迭代次数=20，迭代延迟=0.2秒
2025-05-05 00:15:49.227 | INFO     | __main__:main:249 - 开始执行任务...
2025-05-05 00:15:49.227 | INFO     | core.ui_agent:setup:33 - 正在设置UI代理组件
2025-05-05 00:15:49.227 | DEBUG    | base.perception:__init__:14 - Perception module initialized
2025-05-05 00:15:49.227 | DEBUG    | core.screen_capture:__init__:26 - Screen capture initialized with min interval: 0.2s
2025-05-05 00:15:49.228 | DEBUG    | base.executor:__init__:14 - Executor module initialized
2025-05-05 00:15:49.228 | DEBUG    | core.input_controller:__init__:31 - Input controller initialized, move_duration=0.1, type_interval=0.1
2025-05-05 00:15:49.228 | DEBUG    | base.brain:__init__:14 - Brain module initialized
2025-05-05 00:15:49.228 | INFO     | core.llm_decision:__init__:41 - 使用自定义API端点: https://yunwu.ai/v1
2025-05-05 00:15:49.290 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: default
2025-05-05 00:15:49.290 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: browser
2025-05-05 00:15:49.290 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: text_input
2025-05-05 00:15:49.291 | DEBUG    | utils.prompt_manager:load_prompts:198 - 已加载指定提示词: office
2025-05-05 00:15:49.292 | DEBUG    | utils.prompt_manager:load_prompts:210 - 从文件加载提示词: oxygen_not_included
2025-05-05 00:15:49.292 | INFO     | utils.prompt_manager:load_prompts:237 - 已加载5个提示词
2025-05-05 00:15:49.292 | INFO     | utils.prompt_manager:__init__:44 - 提示词管理器初始化完成，加载了5个提示词
2025-05-05 00:15:49.292 | INFO     | core.llm_decision:__init__:51 - 大模型决策模块初始化完成，使用模型: o4-mini
2025-05-05 00:15:49.292 | INFO     | core.llm_decision:__init__:52 - 已加载5个提示词
2025-05-05 00:15:49.292 | INFO     | core.ui_agent:setup:47 - UI代理组件初始化完成
2025-05-05 00:15:49.292 | INFO     | core.ui_agent:setup_middlewares:51 - 正在设置UI代理中间件
2025-05-05 00:15:49.292 | DEBUG    | base.middleware:__init__:96 - Middleware manager initialized
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:__init__:14 - LoggingMiddleware middleware initialized
2025-05-05 00:15:49.295 | INFO     | middlewares.logging_mw:__init__:26 - 日志中间件初始化完成，日志级别: DEBUG
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:add:111 - Added middleware: LoggingMiddleware
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:__init__:14 - ThrottlingMiddleware middleware initialized
2025-05-05 00:15:49.295 | INFO     | middlewares.throttling:__init__:35 - 限流中间件初始化完成，默认延迟: 1.0秒
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:add:111 - Added middleware: ThrottlingMiddleware
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:__init__:14 - StateTrackingMiddleware middleware initialized
2025-05-05 00:15:49.295 | INFO     | middlewares.state_tracking:__init__:35 - 状态追踪中间件初始化完成，最大历史记录数: 10
2025-05-05 00:15:49.295 | DEBUG    | base.middleware:add:111 - Added middleware: StateTrackingMiddleware
2025-05-05 00:15:49.296 | DEBUG    | base.middleware:__init__:14 - ScreenshotLoggerMiddleware middleware initialized
2025-05-05 00:15:49.297 | DEBUG    | middlewares.screenshot_logger:_ensure_dirs:65 - 创建截图记录目录: logs/screenshots/20250505_001549
2025-05-05 00:15:49.297 | INFO     | middlewares.screenshot_logger:__init__:60 - 截图记录中间件初始化完成，记录目录: logs/screenshots/20250505_001549
2025-05-05 00:15:49.297 | DEBUG    | base.middleware:add:111 - Added middleware: ScreenshotLoggerMiddleware
2025-05-05 00:15:49.297 | INFO     | core.ui_agent:setup_middlewares:66 - UI代理中间件初始化完成
2025-05-05 00:15:49.297 | INFO     | core.ui_agent:run:87 - 开始执行UI代理任务: '建造一个制氧设备'
2025-05-05 00:15:49.297 | INFO     | core.ui_agent:run:88 - 使用提示词: oxygen_not_included
2025-05-05 00:15:49.297 | INFO     | core.ui_agent:run:104 - 迭代 1/20
2025-05-05 00:15:49.297 | DEBUG    | core.ui_agent:step:176 - 开始执行步骤
2025-05-05 00:15:49.297 | DEBUG    | middlewares.logging_mw:process_before_perception:56 - ===== 操作 #1 (迭代 1) 开始 =====
2025-05-05 00:15:49.297 | DEBUG    | core.ui_agent:step:183 - 正在捕获屏幕
2025-05-05 00:15:49.618 | DEBUG    | core.screen_capture:capture:50 - Screen captured: 2560x1440
2025-05-05 00:15:49.999 | DEBUG    | core.screen_capture:process:89 - Processed screen: 2560x1440, cursor at Point(x=3959, y=86)
2025-05-05 00:15:49.999 | DEBUG    | middlewares.logging_mw:process_after_perception:72 - 屏幕状态: 2560x1440, 鼠标位置: Point(x=3959, y=86)
2025-05-05 00:15:50.012 | DEBUG    | middlewares.screenshot_logger:process_after_perception:165 - 截图已保存: logs/screenshots/20250505_001549/step_0001_1746375349_before.png
2025-05-05 00:15:50.013 | DEBUG    | middlewares.logging_mw:process_before_decision:86 - 开始进行决策
2025-05-05 00:15:50.013 | DEBUG    | core.ui_agent:step:193 - 正在进行决策
2025-05-05 00:16:29.738 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-05 00:16:33.784 | DEBUG    | core.llm_decision:_call_api:247 - 正在发送请求到OpenAI API
2025-05-05 00:16:53.931 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时24.19秒
2025-05-05 00:16:53.932 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 150, 'y': 1300}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['o']}, {'type': 'move', 'x': 300, 'y': 1320}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1000, 'y': 700}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-05 00:17:08.669 | DEBUG    | core.llm_decision:_call_api:261 - API响应已接收，耗时34.89秒
2025-05-05 00:17:08.670 | DEBUG    | core.llm_decision:_parse_response:297 - 已解析动作: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 150, 'y': 780}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 180, 'y': 730}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 700, 'y': 450}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-05 00:17:15.362 | INFO     | core.ui_agent:step:195 - 决策结果: [{'type': 'key', 'keys': ['space']}, {'type': 'move', 'x': 150, 'y': 1300}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['o']}, {'type': 'move', 'x': 300, 'y': 1320}, {'type': 'click', 'button': 'left'}, {'type': 'move', 'x': 1000, 'y': 700}, {'type': 'click', 'button': 'left'}, {'type': 'key', 'keys': ['space']}]
2025-05-05 00:17:17.768 | INFO     | middlewares.logging_mw:process_after_decision:99 - 决策: 批量动作 (共 9 个)
2025-05-05 00:17:17.769 | INFO     | middlewares.logging_mw:process_after_decision:101 -   1. 按键 space
2025-05-05 00:17:17.769 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-05 00:17:17.769 | INFO     | middlewares.logging_mw:process_after_decision:101 -   2. 移动鼠标到 (150, 1300)
2025-05-05 00:17:17.769 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 150, "y": 1300}
2025-05-05 00:17:17.769 | INFO     | middlewares.logging_mw:process_after_decision:101 -   3. 点击鼠标 left 在 (0, 0)
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   4. 按键 o
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["o"]}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   5. 移动鼠标到 (300, 1320)
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 300, "y": 1320}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   6. 点击鼠标 left 在 (0, 0)
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   7. 移动鼠标到 (1000, 700)
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "move", "x": 1000, "y": 700}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   8. 点击鼠标 left 在 (0, 0)
2025-05-05 00:17:17.770 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "click", "button": "left"}
2025-05-05 00:17:17.770 | INFO     | middlewares.logging_mw:process_after_decision:101 -   9. 按键 space
2025-05-05 00:17:17.771 | DEBUG    | middlewares.logging_mw:process_after_decision:103 -   动作详情: {"type": "key", "keys": ["space"]}
2025-05-05 00:17:17.771 | DEBUG    | middlewares.screenshot_logger:_log_single_action:94 - 模型分析已保存: logs/screenshots/20250505_001507/step_0001_1746375308_analysis.txt
2025-05-05 00:17:17.772 | DEBUG    | middlewares.screenshot_logger:_log_single_action:129 - 动作已记录到日志: key
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:136 - 模型分析: 步骤1：当前屏幕内容分析
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 周期2，有3名复制人，压力0%，食物储备12525千卡，暂未生产氧气。
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - 中央打印舱已完成，复制人在其附近待命。地形为裸石壁，右侧可见少量藻类资源。底部水体尚未被利用。
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          - UI元素：
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:136 -          • 顶部显示周期、复制人状态、食物、时间控制等；
2025-05-05 00:17:17.772 | INFO     | middlewares.screenshot_logger:_log_single_action:138 -          ... (更多分析内容已保存到文件)
2025-05-05 00:17:25.105 | DEBUG    | middlewares.logging_mw:process_before_execution:119 - 准备执行动作: key
2025-05-05 00:17:26.531 | DEBUG    | core.ui_agent:step:232 - 正在执行动作
2025-05-05 00:18:57.151 | DEBUG    | core.input_controller:_press_key:241 - Key pressed: space
